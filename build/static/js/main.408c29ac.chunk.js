(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n(42)},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),o=n(15),r=n.n(o),c=n(6),s=n(7),u=n(1),i=n.n(u),g=n(2),m=n(4),f=n(5),p=n.n(f),b=null,d={getAll:function(){return p.a.get("/api/blogs").then(function(e){return e.data})},create:function(){var e=Object(g.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:b}},e.next=3,p.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return p.a.put("".concat("/api/blogs","/").concat(e),t).then(function(e){return e.data})},remove:function(e){var t={headers:{Authorization:b}};return p.a.delete("".concat("/api/blogs","/").concat(e),t).then(function(e){return e.data})},setToken:function(e){b="bearer ".concat(e)}},v=l.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),o=Object(m.a)(n,2),r=o[0],c=o[1],s=e.setBlogs,u=e.setNotification,f=e.onClickTest,p={display:r?"":"none"},b=function(){c(!r)};Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:b}});var v=function(){var e=Object(g.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.prev=1,e.next=4,d.update(n,a);case 4:return e.t0=s,e.next=7,d.getAll();case 7:e.t1=e.sent,(0,e.t0)(e.t1),u({message:"New like added!",style:"success"}),setTimeout(function(){u({message:null,style:null})},5e3),e.next=19;break;case 14:e.prev=14,e.t2=e.catch(1),u({message:"Like not added.",style:"failure"}),setTimeout(function(){u({message:null,style:null})},5e3);case 19:case"end":return e.stop()}},e,null,[[1,14]])}));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(g.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("REMOVE id",t),!window.confirm("Do you really want to remove this post?")){e.next=20;break}return e.prev=2,e.next=5,d.remove(t);case 5:return e.t0=s,e.next=8,d.getAll();case 8:e.t1=e.sent,(0,e.t0)(e.t1),u({message:"Blog removed!",style:"success"}),setTimeout(function(){u({message:null,style:null})},5e3),e.next=20;break;case 15:e.prev=15,e.t2=e.catch(2),u({message:"Blog not removed.",style:"failure"}),setTimeout(function(){u({message:null,style:null})},5e3);case 20:case"end":return e.stop()}},e,null,[[2,15]])}));return function(t){return e.apply(this,arguments)}}(),E=function(){var t=Object(g.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),console.log("I Like!"),a=e.blog,console.log("likes before",a.likes),a.likes+=1,console.log("likes after",a.likes),v(a,a.id);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(g.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),a=e.blog,console.log("props.blog.user.id",e.blog.user.id),console.log("Remove this!"),console.log("event.target",n.target),h(a.id);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return l.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,borderBottom:"1px dashed #cecece",marginBottom:5},className:"blogContentFull"},l.a.createElement("div",{className:"blogContent"},l.a.createElement("div",{onClick:b,style:{cursor:"pointer",backgroundColor:"#efefef",padding:"5px 10px"},className:"blogDefault"},l.a.createElement("h3",{className:"blogTitle"},e.blog.title),l.a.createElement("p",{className:"blogAuthor"},e.blog.author))),l.a.createElement("div",{style:p,className:"blogMore"},l.a.createElement("div",{onClick:b,style:{padding:"5px 10px"}},l.a.createElement("p",{className:"blogLikes"},e.blog.likes," likes ",l.a.createElement("button",{onClick:f||E},"Like this")),l.a.createElement("p",{className:"blogUrl"},"Website: ",l.a.createElement("a",{href:e.blog.url,target:"_blank",rel:"noopener noreferrer"},e.blog.url)," ",l.a.createElement("br",null),"Added by: ",e.blog.user?(console.log("props.blog.user.name",e.blog.user.name),e.blog.user.name):"unknown"),l.a.createElement(function(){return console.log("showRemoveButton",e.showRemoveButton),e.showRemoveButton?l.a.createElement("p",null,l.a.createElement("button",{onClick:y},"Remove post")):l.a.createElement("div",null)},null))))}),h=function(e){var t=e.notification;return console.log("Notification: message",t.message),console.log("Notification: style",t.style),console.log("Notification:",t),null===t.message?null:l.a.createElement("div",{className:"notification ".concat(t.style)},t.message)},E=l.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),o=Object(m.a)(n,2),r=o[0],c=o[1],s={display:r?"none":""},u={display:r?"":"none"},i=function(){c(!r)};return Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:i}}),l.a.createElement("div",null,l.a.createElement("div",{style:s},l.a.createElement("button",{onClick:i},e.buttonLabel)),l.a.createElement("div",{style:u,className:"togglableContent"},e.children,l.a.createElement("button",{onClick:i},"cancel")))}),y=function(e){var t=e.addBlogObject,n=e.handleBlogObjectChange,a=e.newBlogObject,o=a.title,r=a.author,c=a.url;return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:t},l.a.createElement("p",null,"title: ",l.a.createElement("input",{name:"title",value:o,onChange:n})),l.a.createElement("p",null,"author: ",l.a.createElement("input",{name:"author",value:r,onChange:n})),l.a.createElement("p",null,"url: ",l.a.createElement("input",{name:"url",value:c,onChange:n})),l.a.createElement("button",{type:"submit"},"save")))},w=function(e){var t=e.handleLogin,n=e.username,a=e.password;return n=Object(c.a)({},n,{reset:null}),a=Object(c.a)({},a,{reset:null}),l.a.createElement("div",{className:"loginForm"},l.a.createElement("h2",null,"Login"),l.a.createElement("form",{onSubmit:t},l.a.createElement("div",null,"username",l.a.createElement("input",n)),l.a.createElement("div",null,"password",l.a.createElement("input",a)),l.a.createElement("button",{type:"submit"},"login")))},O={login:function(){var e=Object(g.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},k=function(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),l=n[0],o=n[1];return{type:e,value:l,onChange:function(e){o(e.target.value)},reset:function(){o("")}}},j=(n(41),function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],o=t[1],r=Object(a.useState)({title:"",author:"",url:""}),u=Object(m.a)(r,2),f=u[0],p=u[1],b=k("text"),j=k("password"),B=Object(a.useState)(null),x=Object(m.a)(B,2),C=x[0],N=x[1],L=Object(a.useState)({message:null,style:null}),S=Object(m.a)(L,2),T=S[0],R=S[1];Object(a.useEffect)(function(){d.getAll().then(function(e){o(e)})},[]),Object(a.useEffect)(function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);N(t),d.setToken(t.token)}},[]);var A=l.a.createRef(),D=function(){var e=Object(g.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),A.current.toggleVisibility(),console.log("addBlog newBlogObject",f.title),console.log("addBlog newBlogObject",f.author),console.log("addBlog newBlogObject",f.url),n={title:f.title,author:f.author,url:f.url},console.log("blogObject",n),a={message:"New blog added: ".concat(f.title," by ").concat(f.author),style:"success"},e.prev=8,e.next=11,d.create(n);case 11:return e.t0=o,e.next=14,d.getAll();case 14:e.t1=e.sent,(0,e.t0)(e.t1),p({title:"",author:"",url:""}),R(a),setTimeout(function(){R({message:null,style:null})},5e3),e.next=26;break;case 21:e.prev=21,e.t2=e.catch(8),R({message:"Blog not created. Check input fields.",style:"failure"}),setTimeout(function(){R({message:null,style:null})},5e3);case 26:case"end":return e.stop()}},e,null,[[8,21]])}));return function(t){return e.apply(this,arguments)}}(),I=function(e){console.log(Object(s.a)({},e.target.name,e.target.value)),p(Object(c.a)({},f,Object(s.a)({},e.target.name,e.target.value))),console.log("newBlogObject",f)};console.log("render",n.length,"blogs.length");var J=function(){var e=Object(g.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,console.log("logging in..."),e.next=5,O.login({username:b.value,password:j.value});case 5:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),d.setToken(n.token),N(n),b.reset(),j.reset(),R({message:"Login successful",style:"success"}),setTimeout(function(){R({message:null,style:null})},5e3),console.log("login successful"),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(1),R({message:"Wrong credentials",style:"failure"}),setTimeout(function(){R({message:null,style:null})},5e3);case 22:case"end":return e.stop()}},e,null,[[1,17]])}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(g.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{window.localStorage.removeItem("loggedBlogappUser"),console.log("logging out..."),N(null),R({message:"Logout successful",style:"success"}),setTimeout(function(){R({message:null,style:null})},5e3),console.log("logout successful")}catch(t){R({message:"Logout error",style:"failure"}),setTimeout(function(){R({message:null,style:null})},5e3)}case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return l.a.createElement("div",{className:"mainPage"},l.a.createElement("h1",null,"Blogit"),l.a.createElement(h,{notification:T}),null===C?l.a.createElement(w,{handleLogin:J,username:b,password:j}):l.a.createElement("div",null,l.a.createElement("p",null,C.name," logged in "),l.a.createElement("button",{onClick:function(){return U()}},"Logout"),l.a.createElement("h2",null,"Create new blog"),l.a.createElement("div",null,l.a.createElement(E,{buttonLabel:"Create new BLOG",ref:A},l.a.createElement(y,{newBlogObject:f,handleBlogObjectChange:I,addBlogObject:D}))),l.a.createElement("h2",{className:"latestBlogs"},"Latest blogs"),function(){console.log("blog",n),console.log("Joku username",C.username);var e=C.username;return n.sort(function(e,t){return t.likes-e.likes}).map(function(t){return console.log("BLOOOOG",t),l.a.createElement(v,{key:t.id,blog:t,setBlogs:o,setNotification:R,showRemoveButton:e===t.user.username})})}()),l.a.createElement(function(){return l.a.createElement("div",{style:{color:"green",fontStyle:"italic",fontSize:16}},l.a.createElement("br",null),l.a.createElement("em",null,"Blog app, Department of Computer Science 2019"))},null))});r.a.render(l.a.createElement(j,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.408c29ac.chunk.js.map